# build/docker/miniblog/Dockerfile.nginx
# 以官方 nginx 镜像为基础
FROM nginx:alpine

# 拷贝主配置和站点；SSL 由 Jenkinsfile 写入 configs/nginx/ssl
COPY configs/nginx/nginx.conf /etc/nginx/nginx.conf
COPY configs/nginx/conf.d /etc/nginx/conf.d
COPY configs/nginx/ssl /etc/nginx/ssl

RUN chmod 644 /etc/nginx/ssl/*.crt \
  && chmod 600 /etc/nginx/ssl/*.key


# 输出 ssl 文件，检查是否正确
RUN ls -al /etc/nginx/ssl
RUN cat /etc/nginx/ssl/yangshujie.com.crt
RUN cat /etc/nginx/ssl/yangshujie.com.key

EXPOSE 80 443
