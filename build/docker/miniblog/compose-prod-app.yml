version: '3.8'
services:
  backend:
    image: yshujie/miniblog:prod      # 不再 build，只用已构建好的镜像
    extra_hosts:
      - "host.docker.internal:host-gateway"
    network_mode: "host"
    environment:
      - DB_HOST=localhost
      - DB_PORT=3306
      - DB_USER=miniblog
      - DB_PASSWORD=miniblog123
      - DB_NAME=miniblog
      - REDIS_HOST=localhost
      - REDIS_PORT=6379
    restart: always
    ports:
      - "8081:8081"

  frontend:
    image: yshujie/miniblog-frontend:prod
    extra_hosts:
      - "host.docker.internal:host-gateway"
    network_mode: "host"
    restart: always
    ports:
      - "3000:3000"